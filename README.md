# brave-news-source-suggestion

Pipeline for producing the source embedding representations and similarity matrix needed for source suggestion feature in Brave News (see https://docs.google.com/document/d/1t-XxP5ykelNyrkCVKE4_wtjIZzqPB7-6ZrYTq-KSg-Q/edit)

## Scripts

`sources-accumulator.py`: parses periodically Brave News's feed, creating buckets for each of the served sources and storing inside all articles originating from each source. These buckets are catalogued by `PUBLISHER_ID` under `output/source_buckets/`. No duplicate articles should be found within any of the source buckets. 

`sources-similarity-matrix.py`: takes in the source buckets and produces an 512-dimensional embedding for each source, built as the mean of the 512-dimensional embeddings of all articles belonging to the source, as generated by the Universal Sentence Encoder model (https://arxiv.org/abs/1803.11175). Once embeddings have been generated for all sources, a similarity matrix is built using cosine distance as similarity metric.

## Outputs

`sources.csv`: [`publisher_name | publisher_id`] is a simple two-column table with all sources' names and publisher ids.

`source_embeddings.csv`: [`index | publisher_id | 0 | 1 ... | ... 511`]  stores all the 512-dimensional embeddings for each source under its `publisher_id`.

`sim_matrix.csv`: stores the SxS similarity matrix, where S is the number of sources collected by the `source-accumulator.py` script.

`*.json`: json equivalents of `sources.csv` and `sim_matrix.csv`, the latter of which has been truncated to store only the top-10 most similar sources.

